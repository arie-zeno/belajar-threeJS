import{F as K}from"./faskes-data-87wLLlVL.js";import{c as P,d as F,W as R,A as V,D as B,G as W,e as I,B as O,V as u,f as G}from"./DRACOLoader-DuWmjkEA.js";function H(x,w){const a=document.getElementById(x);if(!a)return;const p=a.clientWidth,y=a.clientHeight,l=document.createElement("div");l.style.cssText=`
    position:absolute;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.85);color:white;
    display:flex;align-items:center;justify-content:center;
    font-size:18px;z-index:9999;transition:opacity 0.5s ease;
  `,l.textContent="Loading 3D...",a.appendChild(l);const f=new P;f.background=null;const r=new F(75,p/y,.1,2e3);r.position.set(0,2,5);const k=r.position.y,c=new R({antialias:!0,alpha:!0});c.setSize(p,y),c.setPixelRatio(window.devicePixelRatio),a.appendChild(c.domElement);const z=new V(16777215,.6),b=new B(16777215,5);b.position.set(10,10,10),f.add(z,b);const o={forward:!1,backward:!1,left:!1,right:!1},i={up:!1,down:!1,left:!1,right:!1},S=10,L=1.5;let h=0,E=0,d=null;document.addEventListener("keydown",t=>{switch(t.code){case"KeyW":o.forward=!0;break;case"KeyS":o.backward=!0;break;case"KeyA":o.left=!0;break;case"KeyD":o.right=!0;break;case"ArrowUp":i.up=!0;break;case"ArrowDown":i.down=!0;break;case"ArrowLeft":i.left=!0;break;case"ArrowRight":i.right=!0;break}}),document.addEventListener("keyup",t=>{switch(t.code){case"KeyW":o.forward=!1;break;case"KeyS":o.backward=!1;break;case"KeyA":o.left=!1;break;case"KeyD":o.right=!1;break;case"ArrowUp":i.up=!1;break;case"ArrowDown":i.down=!1;break;case"ArrowLeft":i.left=!1;break;case"ArrowRight":i.right=!1;break}});const A=new W,v=new I;v.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),A.setDRACOLoader(v);let D=!1;A.load(w,t=>{const s=t.scene;f.add(s);const n=new O().setFromObject(s),g=n.getCenter(new u),e=n.getSize(new u),m=3;d={minX:n.min.x-m,maxX:n.max.x+m,minY:n.min.y-m,maxY:n.max.y+m*2,minZ:n.min.z-m,maxZ:n.max.z+m},r.position.set(g.x,k,n.max.z+e.z*.2),c.compile(f,r),requestAnimationFrame(()=>{c.render(f,r),l.style.opacity="0",setTimeout(()=>l.remove(),500)}),D=!0},t=>{const s=(t.loaded/t.total*100).toFixed(0);l.textContent=`Loading ${s}%`},t=>console.error("Error loading GLB:",t));const C=new G;function M(){const t=C.getDelta(),s=S*t;if(D&&d){i.left&&(h+=L*t),i.right&&(h-=L*t),r.rotation.set(E,h,0);const n=new u(-Math.sin(h),0,-Math.cos(h)).normalize(),g=new u().crossVectors(n,new u(0,1,0)),e=r.position.clone();o.forward&&e.addScaledVector(n,s),o.backward&&e.addScaledVector(n,-s),o.left&&e.addScaledVector(g,-s),o.right&&e.addScaledVector(g,s),i.up&&(e.y+=s),i.down&&e.y>k&&(e.y-=s),e.x=Math.max(d.minX,Math.min(d.maxX,e.x)),e.y=Math.max(k,Math.min(d.maxY,e.y)),e.z=Math.max(d.minZ,Math.min(d.maxZ,e.z)),r.position.copy(e)}c.render(f,r),requestAnimationFrame(M)}M(),window.addEventListener("resize",()=>{r.aspect=a.clientWidth/a.clientHeight,r.updateProjectionMatrix(),c.setSize(a.clientWidth,a.clientHeight)})}document.addEventListener("DOMContentLoaded",()=>{const w=new URLSearchParams(window.location.search).get("id");if(!w){document.getElementById("viewer-container").innerHTML="<h1>ID Fasilitas tidak ditemukan.</h1>";return}const a=K.find(p=>p.id===w);a&&a.path?H("viewer-container",a.path):document.getElementById("viewer-container").innerHTML=`<h1>Model untuk ID ${w} tidak ditemukan.</h1>`});
